"""
인터넷뱅킹 FAQ 샘플 데이터 생성 스크립트
100-300개의 다양한 FAQ를 생성합니다.
"""
import json
import random
from datetime import datetime, timedelta
from pathlib import Path

# 카테고리 정의
CATEGORIES = [
    "로그인",
    "이체",
    "인증서",
    "오류코드",
    "보안",
    "수수료",
    "한도",
    "계좌등록",
    "비밀번호",
    "공동인증서",
    "OTP",
    "보안카드",
    "계좌조회",
    "거래내역",
    "알림설정"
]

CHANNELS = ["web", "mobile", "both"]

# FAQ 템플릿 데이터
FAQ_TEMPLATES = {
    "로그인": [
        {
            "title": "인터넷뱅킹 로그인 방법",
            "body": "인터넷뱅킹에 로그인하려면 아이디와 비밀번호를 입력한 후, 공동인증서 또는 OTP 인증을 완료해야 합니다. 첫 로그인 시에는 보안카드 인증이 필요할 수 있습니다."
        },
        {
            "title": "로그인 비밀번호를 잊어버렸어요",
            "body": "비밀번호를 잊어버린 경우, 로그인 화면에서 '비밀번호 찾기'를 클릭하세요. 본인인증 후 새 비밀번호를 설정할 수 있습니다. 공동인증서 또는 휴대폰 인증이 필요합니다."
        },
        {
            "title": "로그인이 안돼요",
            "body": "로그인이 안 되는 경우 다음을 확인하세요: 1) 아이디와 비밀번호가 정확한지 확인 2) 공동인증서가 설치되어 있는지 확인 3) 보안프로그램이 최신 버전인지 확인 4) 브라우저 캐시 삭제 후 재시도"
        },
        {
            "title": "5회 연속 로그인 실패로 계정이 잠겼어요",
            "body": "5회 연속 로그인 실패 시 보안을 위해 계정이 일시적으로 잠깁니다. 30분 후 다시 시도하거나, 고객센터(1588-0000)로 문의하여 계정 잠금을 해제할 수 있습니다."
        }
    ],
    "이체": [
        {
            "title": "이체가 안돼요",
            "body": "이체가 안 되는 경우 다음을 확인하세요: 1) 이체 한도 확인 2) 공동인증서 인증 완료 여부 3) 보안카드 번호 입력 정확성 4) 계좌 잔액 확인 5) 이체 가능 시간 확인(평일 09:00-18:00)"
        },
        {
            "title": "이체 한도는 어떻게 되나요?",
            "body": "일일 이체 한도는 계좌 유형에 따라 다릅니다. 일반계좌는 1일 1천만원, 입출금통장은 1일 5천만원입니다. 한도 변경은 인터넷뱅킹 > 보안관리 > 이체한도설정에서 가능합니다."
        },
        {
            "title": "이체 수수료는 얼마인가요?",
            "body": "같은 은행 간 이체는 수수료가 없습니다. 타행 이체의 경우 1회당 500원~1,000원이 부과됩니다. 다만, 인터넷뱅킹 이용 고객은 월 10회까지 무료입니다."
        },
        {
            "title": "이체 내역을 확인하고 싶어요",
            "body": "이체 내역은 인터넷뱅킹 > 거래내역조회에서 확인할 수 있습니다. 기간을 선택하여 조회하거나, 최근 1개월 내역을 바로 확인할 수 있습니다. 모바일뱅킹 앱에서도 확인 가능합니다."
        },
        {
            "title": "이체 오류 코드 E001이 나왔어요",
            "body": "오류 코드 E001은 계좌 정보 오류를 의미합니다. 계좌번호와 예금주명이 정확한지 확인하세요. 타행 계좌 이체 시에는 은행명도 정확히 선택해야 합니다."
        }
    ],
    "인증서": [
        {
            "title": "공동인증서가 설치되지 않아요",
            "body": "공동인증서 설치를 위해 다음을 확인하세요: 1) 보안프로그램 최신 버전 설치 2) 브라우저 호환성 확인(Chrome, Edge 권장) 3) 관리자 권한으로 실행 4) 방화벽/백신 프로그램 예외 설정"
        },
        {
            "title": "공동인증서 비밀번호를 잊어버렸어요",
            "body": "공동인증서 비밀번호를 잊어버린 경우, 인증서를 삭제하고 재발급 받아야 합니다. 인터넷뱅킹 > 공동인증서 관리 > 인증서 재발급 메뉴에서 본인인증 후 새 인증서를 발급받을 수 있습니다."
        },
        {
            "title": "공동인증서가 만료되었어요",
            "body": "공동인증서는 발급 후 1년간 유효합니다. 만료 30일 전부터 갱신 안내가 표시됩니다. 만료된 인증서는 인터넷뱅킹 > 공동인증서 관리 > 인증서 갱신에서 갱신할 수 있습니다."
        },
        {
            "title": "공동인증서를 다른 PC에서 사용하고 싶어요",
            "body": "공동인증서는 USB에 저장하여 다른 PC에서 사용할 수 있습니다. 인터넷뱅킹 > 공동인증서 관리 > 인증서 내보내기에서 USB로 내보낸 후, 다른 PC에서 인증서 가져오기를 실행하세요."
        },
        {
            "title": "공인인증서와 공동인증서의 차이는?",
            "body": "공인인증서는 2020년 말 폐지되었고, 현재는 공동인증서를 사용합니다. 공동인증서는 금융결제원에서 발급하는 전자서명 인증서로, 인터넷뱅킹 거래에 필수입니다."
        }
    ],
    "오류코드": [
        {
            "title": "오류 코드 E001: 계좌 정보 오류",
            "body": "E001 오류는 계좌번호 또는 예금주명이 잘못되었을 때 발생합니다. 계좌번호를 다시 확인하고, 타행 이체 시에는 은행명도 정확히 선택하세요."
        },
        {
            "title": "오류 코드 E002: 잔액 부족",
            "body": "E002 오류는 계좌 잔액이 부족할 때 발생합니다. 이체 금액과 계좌 잔액을 확인하세요. 통장 정지 상태인지도 확인이 필요합니다."
        },
        {
            "title": "오류 코드 E003: 한도 초과",
            "body": "E003 오류는 일일 이체 한도를 초과했을 때 발생합니다. 이체 한도는 인터넷뱅킹 > 보안관리 > 이체한도설정에서 확인 및 변경할 수 있습니다."
        },
        {
            "title": "오류 코드 E004: 인증 실패",
            "body": "E004 오류는 공동인증서 인증이 실패했을 때 발생합니다. 인증서가 정상적으로 설치되어 있는지, 비밀번호가 정확한지 확인하세요."
        },
        {
            "title": "오류 코드 E005: 보안카드 오류",
            "body": "E005 오류는 보안카드 번호 입력이 잘못되었을 때 발생합니다. 보안카드의 해당 번호를 정확히 입력했는지 확인하세요. 보안카드가 손상되었거나 분실된 경우 재발급이 필요합니다."
        }
    ],
    "보안": [
        {
            "title": "보안카드를 분실했어요",
            "body": "보안카드를 분실한 경우 즉시 인터넷뱅킹 접속을 중단하고, 고객센터(1588-0000)로 신고하세요. 신고 후 보안카드 재발급이 필요합니다. 재발급은 지점 방문 또는 인터넷뱅킹에서 가능합니다."
        },
        {
            "title": "보안카드 번호를 입력할 때 주의사항",
            "body": "보안카드 번호는 화면에 표시된 좌표에 해당하는 번호만 입력하세요. 전체 번호를 입력하지 마세요. 예: A3, B5 좌표에 해당하는 숫자 2자리만 입력합니다."
        },
        {
            "title": "OTP 인증이 안돼요",
            "body": "OTP 인증이 안 되는 경우: 1) OTP 앱이 최신 버전인지 확인 2) 스마트폰 시간이 정확한지 확인 3) OTP 번호 입력 시간(30초) 내에 입력 4) OTP 앱 재시작 후 재시도"
        },
        {
            "title": "비밀번호 변경 주기는?",
            "body": "보안을 위해 비밀번호는 6개월마다 변경하는 것을 권장합니다. 인터넷뱅킹 > 보안관리 > 비밀번호 변경에서 언제든지 변경할 수 있습니다. 단순한 비밀번호는 사용하지 마세요."
        },
        {
            "title": "의심스러운 거래 알림을 받았어요",
            "body": "의심스러운 거래 알림을 받은 경우 즉시 고객센터(1588-0000)로 연락하세요. 본인이 거래하지 않은 내역이 있다면 계좌를 일시 정지하고, 비밀번호와 보안카드를 변경하세요."
        }
    ],
    "수수료": [
        {
            "title": "이체 수수료는 얼마인가요?",
            "body": "같은 은행 간 이체는 수수료가 없습니다. 타행 이체는 1회당 500원~1,000원이며, 인터넷뱅킹 이용 고객은 월 10회까지 무료입니다. 수수료는 이체 시 실시간으로 안내됩니다."
        },
        {
            "title": "계좌이체 수수료 면제 조건",
            "body": "월 10회 무료 이체는 인터넷뱅킹 또는 모바일뱅킹을 통해 이체한 경우에만 적용됩니다. 지점 방문 이체는 무료 횟수에 포함되지 않습니다."
        },
        {
            "title": "해외송금 수수료는?",
            "body": "해외송금 수수료는 송금 국가와 금액에 따라 다릅니다. 일반적으로 1회당 5,000원~20,000원이 부과되며, 인터넷뱅킹에서 정확한 수수료를 확인할 수 있습니다."
        }
    ],
    "한도": [
        {
            "title": "이체 한도 확인 방법",
            "body": "이체 한도는 인터넷뱅킹 > 보안관리 > 이체한도설정에서 확인할 수 있습니다. 일반계좌는 1일 1천만원, 입출금통장은 1일 5천만원이 기본 한도입니다."
        },
        {
            "title": "이체 한도 변경 방법",
            "body": "이체 한도 변경은 인터넷뱅킹 > 보안관리 > 이체한도설정에서 가능합니다. 공동인증서 인증 후 한도를 변경할 수 있으며, 변경 사항은 즉시 적용됩니다."
        },
        {
            "title": "한도 초과로 이체가 안돼요",
            "body": "한도 초과 시 이체가 제한됩니다. 한도를 늘리거나 다음 날 다시 시도하세요. 긴급한 경우 지점 방문을 통해 한도 변경이 가능합니다."
        }
    ],
    "계좌등록": [
        {
            "title": "자주 쓰는 계좌 등록 방법",
            "body": "자주 쓰는 계좌는 인터넷뱅킹 > 계좌관리 > 자주쓰는계좌 등록에서 등록할 수 있습니다. 등록된 계좌는 이체 시 빠르게 선택할 수 있어 편리합니다."
        },
        {
            "title": "타행 계좌 등록 시 주의사항",
            "body": "타행 계좌 등록 시 계좌번호, 예금주명, 은행명을 정확히 입력해야 합니다. 정보가 일치하지 않으면 이체가 거부될 수 있습니다."
        }
    ],
    "비밀번호": [
        {
            "title": "비밀번호 변경 방법",
            "body": "비밀번호는 인터넷뱅킹 > 보안관리 > 비밀번호 변경에서 변경할 수 있습니다. 현재 비밀번호와 새 비밀번호를 입력한 후, 공동인증서 인증을 완료하세요."
        },
        {
            "title": "비밀번호 정책",
            "body": "비밀번호는 영문, 숫자, 특수문자를 조합하여 8자 이상 20자 이하로 설정해야 합니다. 연속된 숫자나 생년월일 등 추측하기 쉬운 비밀번호는 사용하지 마세요."
        }
    ],
    "공동인증서": [
        {
            "title": "공동인증서 발급 방법",
            "body": "공동인증서는 인터넷뱅킹 첫 로그인 시 자동으로 발급 안내가 표시됩니다. 발급을 위해 본인인증(휴대폰 인증 또는 지점 방문)이 필요합니다."
        },
        {
            "title": "공동인증서 복사/이동 방법",
            "body": "공동인증서는 USB에 저장하여 다른 PC에서 사용할 수 있습니다. 인터넷뱅킹 > 공동인증서 관리 > 인증서 내보내기에서 USB로 내보낸 후, 다른 PC에서 가져오기를 실행하세요."
        }
    ],
    "OTP": [
        {
            "title": "OTP 앱 설치 방법",
            "body": "OTP 앱은 스마트폰 앱스토어에서 '은행명 OTP'로 검색하여 설치할 수 있습니다. 설치 후 인터넷뱅킹에서 OTP 등록을 완료하면 사용할 수 있습니다."
        },
        {
            "title": "OTP 번호가 생성되지 않아요",
            "body": "OTP 번호가 생성되지 않는 경우: 1) OTP 앱 재시작 2) 스마트폰 시간 동기화 확인 3) OTP 앱 최신 버전 확인 4) 재등록 필요 시 고객센터 문의"
        }
    ],
    "보안카드": [
        {
            "title": "보안카드 재발급 방법",
            "body": "보안카드 재발급은 인터넷뱅킹 > 보안관리 > 보안카드 재발급 또는 지점 방문을 통해 가능합니다. 재발급 시 본인인증이 필요하며, 기존 보안카드는 즉시 무효화됩니다."
        }
    ],
    "계좌조회": [
        {
            "title": "계좌 잔액 조회 방법",
            "body": "계좌 잔액은 인터넷뱅킹 메인 화면에서 바로 확인할 수 있습니다. 모바일뱅킹 앱에서도 실시간 잔액을 확인할 수 있습니다."
        },
        {
            "title": "거래내역 조회 기간",
            "body": "거래내역은 최근 1년까지 조회 가능합니다. 인터넷뱅킹 > 거래내역조회에서 기간을 선택하여 조회하세요. 더 오래된 내역은 지점 방문을 통해 확인할 수 있습니다."
        }
    ],
    "거래내역": [
        {
            "title": "거래내역 다운로드 방법",
            "body": "거래내역은 인터넷뱅킹 > 거래내역조회에서 엑셀 또는 PDF로 다운로드할 수 있습니다. 다운로드한 파일은 개인정보가 포함되어 있으므로 안전하게 보관하세요."
        }
    ],
    "알림설정": [
        {
            "title": "거래 알림 설정 방법",
            "body": "거래 알림은 인터넷뱅킹 > 알림설정에서 설정할 수 있습니다. 이체, 입금, 출금 등 원하는 거래 유형을 선택하고, 알림 방법(SMS, 이메일, 앱 푸시)을 설정하세요."
        }
    ]
}


def generate_faq_id(index: int) -> str:
    """FAQ ID 생성"""
    return f"FAQ{index:04d}"


def generate_url(faq_id: str, category: str) -> str:
    """FAQ URL 생성"""
    return f"https://banking.example.com/faq/{category.lower()}/{faq_id}"


def generate_updated_at() -> str:
    """업데이트 날짜 생성 (최근 2년 내 랜덤)"""
    days_ago = random.randint(0, 730)
    date = datetime.now() - timedelta(days=days_ago)
    return date.strftime("%Y-%m-%d")


def generate_sample_faqs(count: int = 200) -> list:
    """샘플 FAQ 데이터 생성"""
    faqs = []
    faq_id_counter = 1
    
    # 각 카테고리별로 템플릿에서 FAQ 생성
    for category, templates in FAQ_TEMPLATES.items():
        for template in templates:
            if faq_id_counter > count:
                break
            
            channel = random.choice(CHANNELS)
            faq = {
                "faq_id": generate_faq_id(faq_id_counter),
                "title": template["title"],
                "body": template["body"],
                "category": category,
                "url": generate_url(generate_faq_id(faq_id_counter), category),
                "updated_at": generate_updated_at(),
                "channel": channel
            }
            faqs.append(faq)
            faq_id_counter += 1
    
    # 부족한 경우 랜덤 생성
    while len(faqs) < count:
        category = random.choice(CATEGORIES)
        channel = random.choice(CHANNELS)
        faq = {
            "faq_id": generate_faq_id(faq_id_counter),
            "title": f"{category} 관련 질문 {faq_id_counter}",
            "body": f"{category}에 대한 자세한 내용은 인터넷뱅킹 고객센터(1588-0000)로 문의하시거나, 인터넷뱅킹 도움말을 참고하세요.",
            "category": category,
            "url": generate_url(generate_faq_id(faq_id_counter), category),
            "updated_at": generate_updated_at(),
            "channel": channel
        }
        faqs.append(faq)
        faq_id_counter += 1
    
    return faqs[:count]


def main():
    """메인 함수"""
    output_dir = Path(__file__).parent.parent / "data"
    output_dir.mkdir(exist_ok=True)
    
    output_file = output_dir / "raw_faq.jsonl"
    
    print(f"샘플 FAQ 데이터 생성 중...")
    faqs = generate_sample_faqs(count=250)
    
    print(f"{len(faqs)}개의 FAQ 생성 완료")
    print(f"파일 저장 중: {output_file}")
    
    with open(output_file, "w", encoding="utf-8") as f:
        for faq in faqs:
            f.write(json.dumps(faq, ensure_ascii=False) + "\n")
    
    print(f"저장 완료: {output_file}")
    print(f"\n카테고리별 통계:")
    category_counts = {}
    for faq in faqs:
        category_counts[faq["category"]] = category_counts.get(faq["category"], 0) + 1
    
    for category, count in sorted(category_counts.items()):
        print(f"  {category}: {count}개")


if __name__ == "__main__":
    main()
